{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useUnityLoader = void 0;\nvar react_1 = require(\"react\");\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\nvar useUnityLoader = function (unityConfig) {\n  var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading),\n    status = _a[0],\n    setStatus = _a[1];\n  // Effect hook will be invoked when the source changes.\n  (0, react_1.useEffect)(function () {\n    // It is possible for the application being rendered server side. In\n    // this scenario, the window is not available. We can't create a Unity\n    // Loader in this case.\n    if (is_browser_environment_1.isBrowserEnvironment === false) {\n      return;\n    }\n    // If the script's source is null, we'll reset the status to idle.\n    if (unityConfig.loaderUrl === null) {\n      setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n      return;\n    }\n    /**\n     * Find existing script element by source. It may have been added by\n     * another instance of this hook.\n     */\n    var script = window.document.querySelector(\"script[src=\\\"\".concat(unityConfig.loaderUrl, \"\\\"]\"));\n    // If there wan't another instance of this script, we're going to create a\n    // new one with the provided source.\n    if (script === null) {\n      script = window.document.createElement(\"script\");\n      script.type = \"text/javascript\";\n      script.src = unityConfig.loaderUrl;\n      script.async = true;\n      script.setAttribute(\"data-status\", \"loading\");\n      // Add script to window.document body.\n      window.document.body.appendChild(script);\n      // Store status in attribute on script. This can be read by other\n      // instances of this hook.\n      script.addEventListener(\"load\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n      });\n      script.addEventListener(\"error\", function () {\n        return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n      });\n    } else {\n      // If there already was a script with the same source, grab its existing\n      // script status from attribute and set to state.\n      setStatus(script.getAttribute(\"data-status\") === \"loaded\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    }\n    /**\n     * Script event handler to update status in state. Even if the script\n     * already exists we still need to add event handlers to update the state\n     * for this hook instance.\n     * @param event The event that was triggered.\n     */\n    var setStateFromEvent = function (event) {\n      return setStatus(event.type === \"load\" ? unity_loader_status_1.UnityLoaderStatus.Loaded : unity_loader_status_1.UnityLoaderStatus.Error);\n    };\n    script.addEventListener(\"load\", setStateFromEvent);\n    script.addEventListener(\"error\", setStateFromEvent);\n    // Remove event listeners on cleanup.\n    return function () {\n      if (script !== null) {\n        script.removeEventListener(\"load\", setStateFromEvent);\n        script.removeEventListener(\"error\", setStateFromEvent);\n        window.document.body.removeChild(script);\n      }\n    };\n  }, [unityConfig.loaderUrl]);\n  return status;\n};\nexports.useUnityLoader = useUnityLoader;","map":{"version":3,"names":["Object","defineProperty","exports","value","useUnityLoader","react_1","require","is_browser_environment_1","unity_loader_status_1","unityConfig","_a","useState","UnityLoaderStatus","Loading","status","setStatus","useEffect","isBrowserEnvironment","loaderUrl","Idle","script","window","document","querySelector","concat","createElement","type","src","async","setAttribute","body","appendChild","addEventListener","getAttribute","Loaded","Error","setStateFromEvent","event","removeEventListener","removeChild"],"sources":["D:/HeliX/client/node_modules/react-unity-webgl/distribution/hooks/use-unity-loader.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useUnityLoader = void 0;\nvar react_1 = require(\"react\");\nvar is_browser_environment_1 = require(\"../constants/is-browser-environment\");\nvar unity_loader_status_1 = require(\"../enums/unity-loader-status\");\n/**\n * Hook to embed a Unity Loader script.\n * @param source The source of the unity loader.\n * @returns a hook that returns the status of the loader.\n */\nvar useUnityLoader = function (unityConfig) {\n    var _a = (0, react_1.useState)(unity_loader_status_1.UnityLoaderStatus.Loading), status = _a[0], setStatus = _a[1];\n    // Effect hook will be invoked when the source changes.\n    (0, react_1.useEffect)(function () {\n        // It is possible for the application being rendered server side. In\n        // this scenario, the window is not available. We can't create a Unity\n        // Loader in this case.\n        if (is_browser_environment_1.isBrowserEnvironment === false) {\n            return;\n        }\n        // If the script's source is null, we'll reset the status to idle.\n        if (unityConfig.loaderUrl === null) {\n            setStatus(unity_loader_status_1.UnityLoaderStatus.Idle);\n            return;\n        }\n        /**\n         * Find existing script element by source. It may have been added by\n         * another instance of this hook.\n         */\n        var script = window.document.querySelector(\"script[src=\\\"\".concat(unityConfig.loaderUrl, \"\\\"]\"));\n        // If there wan't another instance of this script, we're going to create a\n        // new one with the provided source.\n        if (script === null) {\n            script = window.document.createElement(\"script\");\n            script.type = \"text/javascript\";\n            script.src = unityConfig.loaderUrl;\n            script.async = true;\n            script.setAttribute(\"data-status\", \"loading\");\n            // Add script to window.document body.\n            window.document.body.appendChild(script);\n            // Store status in attribute on script. This can be read by other\n            // instances of this hook.\n            script.addEventListener(\"load\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"loaded\");\n            });\n            script.addEventListener(\"error\", function () {\n                return script === null || script === void 0 ? void 0 : script.setAttribute(\"data-status\", \"error\");\n            });\n        }\n        else {\n            // If there already was a script with the same source, grab its existing\n            // script status from attribute and set to state.\n            setStatus(script.getAttribute(\"data-status\") === \"loaded\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        }\n        /**\n         * Script event handler to update status in state. Even if the script\n         * already exists we still need to add event handlers to update the state\n         * for this hook instance.\n         * @param event The event that was triggered.\n         */\n        var setStateFromEvent = function (event) {\n            return setStatus(event.type === \"load\"\n                ? unity_loader_status_1.UnityLoaderStatus.Loaded\n                : unity_loader_status_1.UnityLoaderStatus.Error);\n        };\n        script.addEventListener(\"load\", setStateFromEvent);\n        script.addEventListener(\"error\", setStateFromEvent);\n        // Remove event listeners on cleanup.\n        return function () {\n            if (script !== null) {\n                script.removeEventListener(\"load\", setStateFromEvent);\n                script.removeEventListener(\"error\", setStateFromEvent);\n                window.document.body.removeChild(script);\n            }\n        };\n    }, [unityConfig.loaderUrl]);\n    return status;\n};\nexports.useUnityLoader = useUnityLoader;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}